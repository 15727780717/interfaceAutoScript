- name: pool
  request:
    method: GET
    url: /api/v1/client/pledge_manage/pool?id=11&needCancelRequest=true&needCancelUrl=%2Fpledge_manage%2Fpool
  # ĞèÒªÌáÈ¡µÄ²ÎÊıÁĞ±í
  extract:
    - pledgeItemAddress: $.result.pledgeItemAddress  # Æ¥Åä¹æÔò
  # ¶ÏÑÔ
  assertions:
    # ×´Ì¬Âë¶ÏÑÔ
    - eq: ["status_code", 200]
    # JSONÏìÓ¦¶ÏÑÔ
    - eq: ["$.code", 0]
    - eq: ["$.msg", "success"]
    - contains: ["$.result", "title"]

- name: pledge_logs
  request:
    method: GET
    url: /api/v1/client/pledge_manage/pledge_logs?page=1&pageSize=99&poolId=11&needCancelRequest=true&needCancelUrl=%2Fpledge_manage%2Fpledge_logs
  extract:
    - pledgeId: $.result.dataList[0].id  # ÖÊÑºÎïÆ·id
    - pledgeTokenId: $.result.dataList[0].pledgeTokenId  # Æ¥Åä¹æÔò
  # ¶ÏÑÔ
  assertions:
    # ×´Ì¬Âë¶ÏÑÔ
    - eq: ["status_code", 200]
    # JSONÏìÓ¦¶ÏÑÔ
    - eq: ["$.code", 0]
    - eq: ["$.msg", "success"]

- name: pledge_award_logs
  request:
    method: GET
    url: /api/v1/client/pledge_manage/pledge_award_logs?page=1&pageSize=99&poolId=11&pledgeId=${pledgeId}&status=1
  # ¶ÏÑÔ
  assertions:
    # ×´Ì¬Âë¶ÏÑÔ
    - eq: ["status_code", 200]
    # JSONÏìÓ¦¶ÏÑÔ
    - eq: ["$.code", 0]
    - eq: ["$.msg", "success"]
    - contains: ["$.result", "dataList"]

- name: estimate_fee
  request:
    method: GET
    url: /api/v1/client/eth/estimate_fee?type=13&coin=eth&chain=1&tokenId=${pledgeTokenId}&collectAddress=${pledgeItemAddress}
  # ¶ÏÑÔ
  assertions:
    # ×´Ì¬Âë¶ÏÑÔ
    - eq: ["status_code", 200]
    # JSONÏìÓ¦¶ÏÑÔ
    - eq: ["$.code", 0]
    - eq: ["$.msg", "success"]

- name: pledge_choice_list
  request:
    method: GET
    url: /api/v1/client/pledge_manage/pledge_choice_list?collectAddress=${pledgeItemAddress}
  # ¶ÏÑÔ
  assertions:
    # ×´Ì¬Âë¶ÏÑÔ
    - eq: ["status_code", 200]
    # JSONÏìÓ¦¶ÏÑÔ
    - eq: ["$.code", 0]
    - eq: ["$.msg", "success"]
    - contains: ["$.result[0]", "tokenId"]

